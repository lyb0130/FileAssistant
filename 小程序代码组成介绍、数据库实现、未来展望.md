

## 程序代码组成介绍

云函数

1. delete_excel: 删除指定名称的问卷
2. down_excel: 从数据库查询数据的常用函数，功能：访问[db_name]值命名的数据库，查找关键词[keyword]的对应值为[value]的数据（注：在此，以[a]表示变量a的值）
3. export_excel: 将指定问卷数据存入云存储，并生成下载链接
4. get_date: 获取当前服务器时间，并输出为北京时间的时间戳
5. save_openID: 将用户的openID存入数据库中，为实现发送订阅消息功能做准备
6. send_message: 每隔半小时自动触发的云函数，用于给待填写问卷者发送提醒消息，给发布者发送到期消息以及下载链接（订阅消息功能尚未测试）
7. submit_data: 将所填写数据存入数据库，并在数据库中显示为已提交
8. up_excel: 将云存储中的excel文件进行解析，并上传至数据库中（已完成上传即亚注册功能）
9. update_excel: 更新用户信息

界面

home：
1. index: 主界面，可实现问卷展示、倒计时、上传、填写、显示详情等功能
2. detail: 详情页，显示未提交人数及其名单，也可实现问卷导出、删除功能
3. survey: 问卷填写界面，显示问卷问题以及上次提交的答案，为高频次填写同一问卷的情况提供了便利，可重复填写
4. upLoad：上传界面，设定截止日期后，即可上传指定格式excel文件

personalCenter：
1. mine: 个人中心
2. about： 关于我们
3. advice：意见反馈
4. help：使用手册
5. info：完善个人信息界面

## 数据库

1. demo：存储所有问卷

--_id：系统自动生成
--title(string)：表格标题
--creater_id(number): 发布者的学工号
--deadline(string): 截止时间 格式：2020/10/22 00:00:00
--header(array): 表格的表头 
--content(二维数组): 表格内容，即问卷提交的内容，第一列为IsSubmit的值，若已经提交，则第一列为true，反之则为false；采用二维数组格式，为上传、展示、导出提供了便利

2. user：用户信息

--_id：系统自动生成
--sno(number): 学工号
--姓名(string): 即姓名
--_openid(string): 用户唯一标识
--myCreat(array): 存储所发布的问卷的文档名称
--toMeFile(对象数组): 存储所需填写和已完成的问卷，每个对象包括IsSubmit、title、deadline三个属性

3. advice：存储反馈的意见

## 未来展望

1. 实现问卷的按频率自动发布，如每日打卡；并新增是否更改选项，若不更改则系统自动提交，而用户无需打开问卷；新增在导出时，更改内容标红，便于发布者审阅
2. 将问卷按照截止时间划分等级，以不同颜色显示（轻、缓、急）
3. 导出excel时，按照原格式导出
4. 加入多个表格上传板块，使其可以识别多种内容格式的excel文件（易）；实现表格内容格式的自动识别（较难）
5. 加入域名后实现超链接功能，使得导出时系统可以进行下载，之后可以加入按时发送给某位用户（如发布者的上级领导）的功能























